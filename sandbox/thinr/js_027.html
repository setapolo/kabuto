
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">

<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

        <title>Babylon.js sample code</title>

        <!-- Babylon.js -->
        <script src="https://code.jquery.com/pep/0.4.2/pep.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/dat-gui/0.6.2/dat.gui.min.js"></script>
        <script src="https://preview.babylonjs.com/ammo.js"></script>
        <script src="https://preview.babylonjs.com/cannon.js"></script>
        <script src="https://preview.babylonjs.com/Oimo.js"></script>
        <script src="https://preview.babylonjs.com/libktx.js"></script>
        <script src="https://preview.babylonjs.com/earcut.min.js"></script>
        <script src="https://preview.babylonjs.com/babylon.js"></script>
        <script src="https://preview.babylonjs.com/inspector/babylon.inspector.bundle.js"></script>
        <script src="https://preview.babylonjs.com/materialsLibrary/babylonjs.materials.min.js"></script>
        <script src="https://preview.babylonjs.com/proceduralTexturesLibrary/babylonjs.proceduralTextures.min.js"></script>
        <script src="https://preview.babylonjs.com/postProcessesLibrary/babylonjs.postProcess.min.js"></script>
        <script src="https://preview.babylonjs.com/loaders/babylonjs.loaders.js"></script>
        <script src="https://preview.babylonjs.com/serializers/babylonjs.serializers.min.js"></script>
        <script src="https://preview.babylonjs.com/gui/babylon.gui.min.js"></script>

        <style>
            html, body {
                overflow: hidden;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
            }

            #renderCanvas {
                width: 100%;
                height: 100%;
                touch-action: none;
            }
        </style>
    </head>
<body>
    
    <script>

    </script>
</body>
</html>

<script type="text/javascript">
//CCas Closure Cascading v.0.03 2020/3/28 moka
var tags=function(s){
  return function(p){
    return function(a){
      var e = document.createElement(s);
      e = Object.assign(e,a);
      p.appendChild(e);
      return e
    }
  }
};

script=tags("script");
canvas=tags("canvas");
div=tags("div");

Babylonjs=function(yyy){
  return function(a){
    var name = (a["name"])?a["name"]:"renderCanvas";
    var ret=[function(){
        window.canvas = document.getElementById("renderCanvas");

        window.engine = null;
        window.scene = null;
        window.sceneToRender = null;
        window.createDefaultEngine = function() { return new BABYLON.Engine(canvas, true, { preserveDrawingBuffer: true, stencil: true }); };



    }];
    return ret;
  }
};
dragon_box=function(xxx){
  return function(a){
    var background = (a["background"])?a["background"]:[1, 0.8, 0.8];
    xxx.push(function(){
        window.createScene = function() {
            function newCall(Cls) {
                return new (Function.prototype.bind.apply(Cls, arguments));
            }
            // Scene setup
            var scene = new BABYLON.Scene(engine);
            scene.clearColor =(newCall.apply(this, [BABYLON.Color3,1, 0.8, 0.8]));

            var camera = new BABYLON.ArcRotateCamera("Camera", 3 * Math.PI / 2, Math.PI / 2, 5, BABYLON.Vector3.Zero(), scene);
            camera.attachControl(canvas, false);
            var light = new BABYLON.HemisphericLight("light1", new BABYLON.Vector3(0, 1, 0), scene);
            light.intensity = 0.7;

            // Create material from image with alpha
            var mat = new BABYLON.StandardMaterial("dog", scene);
            mat.diffuseTexture = new BABYLON.Texture("https://upload.wikimedia.org/wikipedia/commons/thumb/2/24/Chinese_dragon_asset_heraldry.svg/440px-Chinese_dragon_asset_heraldry.svg.png", scene);

            mat.diffuseTexture.hasAlpha = true;
            mat.backFaceCulling = false;
        
            // Apply material to a box
            var box = BABYLON.MeshBuilder.CreateBox("box", {}, scene);
            box.material = mat;
        
            return scene;
        };
        
        engine = createDefaultEngine();
        if (!engine) throw 'engine should not be null.';
        scene = createScene();;
        sceneToRender = scene

        engine.runRenderLoop(function () {
            if (sceneToRender) {
                sceneToRender.render();
            }
        });

        // Resize
        window.addEventListener("resize", function () {
            engine.resize();
        });
    });
    return xxx;
  }
};
onload=function(){
  return function(){
    document.body.onload=init;
  }
}
set_controls=function(xxx){
  return function(a){
    window.init=function(){
    console.log("init")

      xxx.map(function(c){
        console.log(c());
      });
    };




    return null;
  }
};

(function (w,flg){
  return function(d,flg){
    var a={};
    var aa=[null];
    var aaa=[];
    var lv=[document.body];
    var k=null;
    var parent=document.body;
    var f= function(c){
        var _f = (typeof c=="function")?c:null;
        (k==null)?(_f!=null)?function(){
          aaa.push(a);
          aa.push(_f);
          a={};
        }():0:0;        
//        (typeof c=="object")?(function(){
//              console.log(window[c.source]);
//              c=(window[c.source])?window[c.source]:c;
//              a = Object.assign(a,c);
//        }()):0;
        (c==null)?(function(){
            (a!=null)?(aaa.push(a)):0;
            aa.map(function(cc,i){
                parent =  (cc!=null)?cc(lv[lv.length -1])(aaa[i]):document.body;
                (parent != document.body)?lv.push(parent):0;
            });
            lv.pop();
            aaa=[];
            aa=[null];
        })():0;
        var v =(k != null)?c:null;
        k=(typeof c=="string")?(k==null)?c:k:k;
        ((k!=null)&&(v!=null))?a[k]=v:0;
        k=((k!=null)&&(v!=null))?null:k;
      return f;
    }
    return f;
  };
})(window)
    (document)
      (canvas)
        ("id")("renderCanvas")()
      (Babylonjs)
        ("name")("renderCanvas")
        (dragon_box)
          ("background")([1, 0.8, 0.9])()  
      (set_controls)()()
    (onload)
      ("1")(init)()
           ;
</script>
